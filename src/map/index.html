<!DOCTYPE html>
<html>
<head>
	<title>Map</title>
	<meta charset="utf-8">
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>
</head>
<body>
	<div id='printoutPanel'></div>
  <div id='myMap' style='width: 100vw; height: 100vh;'></div>
	<script type="text/javascript">
		function loadMapScenario(){
			var map = new Microsoft.Maps.Map(document.getElementById('myMap'), {
			    credentials: 'Am808_tBNMI958nFN95FX2oBKxPNOahsq7vyuUA-ZbPuyiNTUr7L07irajvZl0rh',
			    center: new Microsoft.Maps.Location(51.50632, -0.12714),
			    mapTypeId: Microsoft.Maps.MapTypeId.aerial,
			    zoom: 15
			});
		}
		function messageCallback(message){
			const data = JSON.parse(message.data)
			console.log('Got a message', data)
		}
		function grabData(){
			console.log('WebSocket started')
			const socket = new WebSocket('ws://localhost:8978')
			socket.onmessage = messageCallback
		}
		grabData()
	</script>
  <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?callback=loadMapScenario' async defer></script>
</body>
</html>